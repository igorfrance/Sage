<!DOCTYPE html>
<html
	xmlns:sage="http://www.cycle99.com/schemas/sage/sage.xsd"
	xmlns:mod="http://www.cycle99.com/schemas/sage/modules.xsd"
 	xmlns:xi="http://www.w3.org/2003/XInclude"
	xmlns="http://www.w3.org/1999/xhtml">

	<head>
		<sage:basehref/>
		<title>Merging with Kelp</title>
	</head>
	<body>

		<h1>Merging with Kelp</h1>

		<mod:BreadCrumb>
			<mod:config>
				<mod:current><sage:url ref="resource-processing-kelp"/></mod:current>
			</mod:config>
		</mod:BreadCrumb>

		<dl>
			<dt><a href="url(resource-processing-kelp)">JavaScript and CSS merging</a></dt>
			<dd>
				<p>
					A larger number of reasonably small, reusable and well-organized files is often more maintable then single large files.
					Developers frequently organize their scripts and styles in many separate documents, organized in
					various ways. A moderately complex web page can easily end up with 20+ individual scripts or stylesheets that
					all need to be loaded for the page to be fully functional.
				</p>
				<p>
					The downside of using this approach is that for each of these files, there will be an additional latency
					added to each of these files' request. That is, for each file the browser has to make a separate request,
					and wait for the reponse from the server. This results in slower loading times than in scenarios where all
					scripts and styles arrive in one or two larger responses. The more separate files are used, the bigger the
					hit will be; and conversely, the bigger will the speed gain be if the files are served together with fewer
					requests.
				</p>
				<p>
					Sage solves this problem using fluid resource inclusion to merge separate scripts and styles into single files,
					and conditionally outputting them back as separate requests during development.
					<a href="url(resource-processing-kelp)">Find out more</a>.
				</p>
			</dd>
		</dl>

		<p>
			Dividing the code in small, reusable and well-organized files help keep our development maintanable, much in the
			spirit of "Divide and Conquer".
		</p>
		<p>
			The downside of this approach is that since each of these resources needs to be accessed individually, there is
			some latency added to each request and the overall experience of the site will be slower than if all of those
			resources were to be in the same file, where possible. And the more resources there are, the more noticable this
			difference will be.
		</p>
		<p>
			The approach Sage uses is to use <a href="url(kelp)" class="tooltip" title="This is some great text">Kelp</a> to open files that may be merged, and depending on
			whether the <a href="url(configuration-project)">project is configured</a> to merge resources or not to output
			a single script element with everything merged, or to output individual script elements for all resources that
			have been merged in the source file.
		</p>
		<p>
			This makes it possible to have all scripts and stylesheets served as individual resources during development,
			and have them all merged when the project gets deployed to production, simply by changing a configuration property.
		</p>

		<h2 class="section">Merging</h2>
		<p>
			Kelp supports including JavaScript and CSS files by using a special comment syntax.
		</p>

		<mod:SyntaxHighlighter>
			<mod:config>
				<mod:language>javascript</mod:language>
			</mod:config>
			<mod:code>
				var x = 10;
				/*# Include: relative/path.js */
			</mod:code>
		</mod:SyntaxHighlighter>

	</body>
</html>
