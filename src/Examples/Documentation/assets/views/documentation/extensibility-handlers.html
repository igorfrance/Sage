<!DOCTYPE html>
<html
	xmlns:sage="http://www.cycle99.com/projects/sage"
	xmlns:mod="http://www.cycle99.com/projects/sage/modules"
 	xmlns:xi="http://www.w3.org/2003/XInclude"
	xmlns="http://www.w3.org/1999/xhtml">

	<head>
		<sage:basehref/>
		<title>Node and text handlers</title>
	</head>
	<body>

		<h1>Node and text handlers</h1>

		<mod:BreadCrumb>
			<mod:config>
				<mod:current><sage:url ref="extensibility-handlers"/></mod:current>
			</mod:config>
		</mod:BreadCrumb>

		<p>
			Sage <a sage:attrib="href:url(xml-flow-copy-tree)">filters all XML document trees</a> through registered node
			handlers. To add custom handlers, you simply decorate the designated method with the appropriate attribute.
		</p>

		<p>
			These are the delegate signatures:
		</p>

		<blockquote class="clear">

			<h6 class="caption">Node handler</h6>
			<mod:SyntaxHighlighter>
				<mod:config>
					<mod:language>c#</mod:language>
					<mod:keywords>
						<mod:group name="type">
							XmlNode|SageContext
						</mod:group>
					</mod:keywords>
					<mod:code>

						delegate XmlNode ProcessNode(XmlNode node, SageContext context);

					</mod:code>
				</mod:config>
			</mod:SyntaxHighlighter>

			<h6 class="caption">Text handler</h6>
			<mod:SyntaxHighlighter>
				<mod:config>
					<mod:language>c#</mod:language>
					<mod:keywords>
						<mod:group name="type">
							XmlNode|SageContext
						</mod:group>
					</mod:keywords>
					<mod:code>

						delegate XmlNode ProcessText(XmlNode node, SageContext context);

					</mod:code>
				</mod:config>
			</mod:SyntaxHighlighter>

		</blockquote>

		<p class="section">
			Any method that matches this signature can be registered as a node handler by using the
			<code>NodeHandlerAttribute</code>. For instance:
		</p>

		<blockquote>
			<h6 class="caption">Marking a method as a node handler</h6>
			<mod:SyntaxHighlighter>
				<mod:config>
					<mod:language>c#</mod:language>
					<mod:keywords>
						<mod:group name="type">
							NodeHandler|SageContext|XmlNode
						</mod:group>
						<mod:group name="enum">
							XmlNodeType
						</mod:group>
						<mod:group name="value">
							Element
						</mod:group>
					</mod:keywords>
					<mod:code>

						[NodeHandler(XmlNodeType.Element, "switch", "http://www.cycle99.com/projects/sage/contextualization")]
						internal static XmlNode ProcessContextSwitchNode(XmlNode switchNode, SageContext context)
						{
							// actual code here
						}

					</mod:code>
				</mod:config>
			</mod:SyntaxHighlighter>

			<h6 class="caption">Marking a method as a text handler</h6>
			<mod:SyntaxHighlighter>
				<mod:config>
					<mod:language>c#</mod:language>
					<mod:keywords>
						<mod:group name="type">
							NodeHandler|SageContext|XmlNode
						</mod:group>
						<mod:group name="enum">
							XmlNodeType
						</mod:group>
						<mod:group name="value">
							Element
						</mod:group>
					</mod:keywords>
					<mod:code>

						[TextHandler("assetpath", "sharedassetpath", "modulepath")]
						internal static string ResolveVariable(string variable, SageContext context)
						{
							// actual code here
						}

					</mod:code>
				</mod:config>
			</mod:SyntaxHighlighter>
		</blockquote>

	</body>
</html>
