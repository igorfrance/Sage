atom.controls.Scroller=atom.controls.register(new function(){function s(){this.enabled?(this.$element.toggleClass("atom-hscrollable",this.isScrollableHorizontally()),this.$element.toggleClass("atom-vscrollable",this.isScrollableVertically())):this.$element.removeClass("atom-hscrollable atom-vscrollable")}function h(){this.$trackVertical.toggle()}function c(t){var i=r[t],h=t==n.HORIZONTAL?this.$trackHorizontal:this.$trackVertical,u=t==n.HORIZONTAL?this.$gripHorizontal:this.$gripVertical,f,e,a,v;t==n.HORIZONTAL?(f=parseInt(this.$gripVertical.css("top"))||0,e=parseInt(this.$gripVertical.css("bottom"))||0):(f=parseInt(this.$gripVertical.css("left"))||0,e=parseInt(this.$gripVertical.css("right"))||0);var o=this[i.scrollSize](),c=this.$element[i.size](),l=h[i.size](),s=u[i.size]();o>c?(a=parseInt(h.css(i.scrollPaddingSize)),this.$content.css(i.scrollPadding,this.$content.data("_"+i.scrollPadding)+a),o=this[i.scrollSize](),v=l-(f+e),this.scrollRatio[t]=v/o,s=Math.round(c*this.scrollRatio[t]),u.css(i.size,s),u.data("minScroll",f),u.data("maxScroll",l-s-e)):this.$content.css(i.scrollPadding,this.$content.data("_"+i.scrollPadding))}function b(){var n=this.$scrollGrip,t=n.data("orientation"),i=r[t],u=n.position()[i.position],f=Math.round(u/this.scrollRatio[t]);this.$scroller.prop(i.scrollPos,f)}function k(){var t=this.$scroller.prop("scrollTop"),i=this.$scroller.prop("scrollLeft"),r=Math.round(t*this.scrollRatio[n.VERTICAL]),u=Math.round(i*this.scrollRatio[n.HORIZONTAL]);this.$gripVertical.css("top",Math.min(Math.max(this.$gripVertical.data("minScroll"),r),this.$gripVertical.data("maxScroll"))),this.$gripHorizontal.css("left",Math.min(Math.max(this.$gripHorizontal.data("minScroll"),u),this.$gripHorizontal.data("maxScroll")))}function u(n,t){l.call(this,n),this.$element.addClass(o[n]),t&&d.call(this,n,!0)}function f(n){this.$element.removeClass(o[n])}function d(n){l.call(this,n),this.switches[n].id=setTimeout($.proxy(f,this,n),this.switches[n].duration)}function l(n){this.switches[n]&&clearTimeout(this.switches[n].id)}function a(t){var r=$(t.currentTarget),f=r.closest(".atom-scrolltrack"),i,u;atom.drag.on("move",this.onDragMove);atom.drag.on("stop",this.onDragEnd);return i=r.data("orientation")==n.VERTICAL,u={moveX:!i,moveY:i,minX:this.$gripHorizontal.data("minScroll"),maxX:this.$gripHorizontal.data("maxScroll"),minY:this.$gripVertical.data("minScroll"),maxY:this.$gripVertical.data("maxScroll")},atom.drag.start(t,t.currentTarget,u),this.fireEvent("dragstart"),f.addClass("active"),this.$scrollGrip=r,this.scrollOrientation=i?n.VERTICAL:n.HORIZONTAL,!1}function g(){b.call(this)}function nt(){atom.drag.off("move",this.onDragMove),atom.drag.off("stop",this.onDragEnd);var n=this.$scrollGrip.closest(".atom-scrolltrack");n.removeClass("active"),this.scrollOrientation=null,this.fireEvent("dragend"),this.$trackVertical.removeClass("active")}function tt(){u.call(this,"ENGAGED",!0),k.call(this),this.fireEvent("scroll")}function v(n){n.stopPropagation()}function y(n){n.stopPropagation()}function p(n){var s=$(n.currentTarget),f=s.find(".atom-scrollgrip"),t=r[f.data("orientation")],e=parseInt(f.css(t.position)),h=parseInt(e+f[t.size]()),o=n[t.offsetPos],i,u;(o<e||o>h)&&(i=this.$scroller[t.size](),u=this.$scroller.prop(t.scrollPos),o<e?(console.log("Moving from click to: "+(u-i)),this.$scroller.prop(t.scrollPos,u-i)):(console.log("Moving from click to: "+(u+i)),this.$scroller.prop(t.scrollPos,u+i)))}function it(n){atom.event.isMouseInRange(n,this.$element)&&(this.mouseInRange||(u.call(this,"HOVER"),this.mouseInRange=!0,rt.call(this,n))),atom.event.isMouseInRange(n,this.$element)||this.mouseInRange&&(f.call(this,"HOVER"),this.mouseInRange=!1,ut.call(this,n))}function rt(n){var i,r;if(this.isScrollable()&&this.enabled)for(u.call(this,"HOT",!0),n.stopPropagation(),s.call(this),i=this.$element.parent();i.length!=0;)r=t.get(i),r!=null&&h.call(this),i=i.parent()}function ut(){var n,i;if(this.isScrollable()&&this.enabled)for(f.call(this,"HOT"),n=this.$element.parent();n.length!=0;)i=t.get(n),i!=null&&h.call(this),n=n.parent()}function ft(n){if(!this.enabled||!this.isScrollable()||this.isScrollableVertically()||n.shiftKey)return!0;var t=this.$scroller.wheelDelta(n),i=this.scrollLeft();this.scrollLeft(i-t.deltaY*30)}function et(){var n=$("<div style='position: absolute; top:-1000px; left:-1000px; width:100px; height:100px; overflow:scroll;'><\/div>").appendTo("body");return{width:n.width()-n[0].clientWidth,height:n.height()-n[0].clientHeight}}var t=this,e={FIXED:0,PROPORTIONAL:1},w=20,i=null,n={VERTICAL:1,HORIZONTAL:2},r={"1":{scrollSize:"scrollHeight",scrollPos:"scrollTop",offsetPos:"offsetY",size:"height",outerSize:"outerHeight",position:"top",scrollPadding:"paddingRight",scrollPaddingSize:"width"},"2":{scrollSize:"scrollWidth",scrollPos:"scrollLeft",offsetPos:"offsetX",size:"width",outerSize:"outerWidth",position:"left",scrollPadding:"paddingBottom",scrollPaddingSize:"height"}},o={HOVER:"hover",HOT:"hot",ENGAGED:"engaged"};this.NAME="atom.controls.Scroller",this.async=!1,this.expression=".scrollable",this.setup=function(){w=parseInt($("body").css("line-height"))||20;$(window).on("resize",this.redraw)},this.redraw=function(){for(var n=0;n<t.instances.length;n++)t.instances[n].redraw()},this.Settings=atom.Settings.extend(function(n,t){var i=this.getString("sizing",n,t,"").toLowerCase();this.sizing=i=="fixed"?e.FIXED:e.PROPORTIONAL,this.animate=this.getBoolean("animate",n,t,!0)}),this.Control=function(r,u){this.construct(r,"scroll","dragstart","dragend"),this.settings=new t.Settings(r,u),this.mouseInRange=!1,i==null&&(i=et()),this.$element.find("> .atom-scroller").length==0&&(this.$element.html(atom.string.format("<div class='atom-scroller'><div class='atom-scrollcontent'>{0}<\/div><\/div><div class='atom-scrolltrack vertical'><div class='atom-scrollgrip'/><\/div><div class='atom-scrolltrack horizontal'><div class='atom-scrollgrip'/><\/div>",this.$element.html())),atom.controls.update(this.$element)),this.$scroller=this.$element.find("> .atom-scroller"),this.$content=this.$scroller.find("> .atom-scrollcontent"),this.$trackVertical=this.$element.find("> .atom-scrolltrack.vertical"),this.$gripVertical=this.$trackVertical.find("> .atom-scrollgrip"),this.$trackHorizontal=this.$element.find("> .atom-scrolltrack.horizontal"),this.$gripHorizontal=this.$trackHorizontal.find("> .atom-scrollgrip"),this.$content.css("padding",this.$element.css("padding")),this.$content.data("_paddingRight",parseInt(this.$content.css("paddingRight"))||0),this.$content.data("_paddingBottom",parseInt(this.$content.css("paddingBottom"))||0),this.$scroller.css({right:-i.width,bottom:-i.height}),this.scrollRatio={};this.$scroller.on("scroll",$.proxy(tt,this));if(this.onDragMove=$.proxy(g,this),this.onDragEnd=$.proxy(nt,this),this.offsetVertical=parseInt(this.$gripVertical.css("top"))||0,this.offsetHorizontal=parseInt(this.$gripHorizontal.css("left"))||0,this.scrollOrientation=null,this.enabled=!0,this.overflow=this.$scroller.css("overflow"),this.switches={HOVER:{id:0,duration:2e3},ENGAGED:{id:0,duration:500},HOT:{id:0,duration:1500}},!atom.dom.isTouchDevice())$(document).on("mousemove",$.proxy(it,this));this.$gripVertical.data("orientation",n.VERTICAL).on("mousedown",$.proxy(a,this)).on("click",atom.event.cancel);this.$gripHorizontal.data("orientation",n.HORIZONTAL).on("mousedown",$.proxy(a,this)).on("click",atom.event.cancel);this.$trackVertical.on("mouseenter",$.proxy(v,this)).on("mouseleave",$.proxy(y,this)).on("click",$.proxy(p,this));this.$trackHorizontal.on("mouseenter",$.proxy(v,this)).on("mouseleave",$.proxy(y,this)).on("click",$.proxy(p,this));this.$scroller.on("mousewheel DOMMouseScroll",$.proxy(ft,this));t.registerInstance(this),this.redraw()},this.Control.inherits(atom.HtmlControl),this.Control.prototype.enable=function(){this.enabled=!0,this.redraw(),this.isScrollable()&&(this.$scroller.css("overflow",atom.string.EMPTY),this.$trackVertical.show())},this.Control.prototype.disable=function(){this.enabled=!1,this.$trackVertical.hide(),this.$scroller.css("overflow","hidden")},this.Control.prototype.isScrollable=function(){return this.isScrollableVertically()||this.isScrollableHorizontally()},this.Control.prototype.isScrollableVertically=function(){var n=this.$scroller.prop("scrollHeight"),t=this.$scroller.outerHeight();return n>t},this.Control.prototype.isScrollableHorizontally=function(){var n=this.$scroller.prop("scrollWidth"),t=this.$scroller.outerWidth();return n>t},this.Control.prototype.scrollLeft=function(n){return!isNaN(n)&&n>=0&&this.$scroller.prop("scrollLeft",n),this.$scroller.prop("scrollLeft")},this.Control.prototype.scrollTop=function(n){return!isNaN(n)&&n>=0&&this.$scroller.prop("scrollTop",n),this.$scroller.prop("scrollTop")},this.Control.prototype.scrollHeight=function(n){return!isNaN(n)&&n>0&&(this.$content.css("height",n),this.redraw()),this.$content.prop("scrollHeight")},this.Control.prototype.scrollWidth=function(n){return!isNaN(n)&&n>0&&(this.$content.css("width",n),this.redraw()),this.$content.prop("scrollWidth")},this.Control.prototype.scrollMaxLeft=function(){return this.scrollWidth()-this.$content.width()},this.Control.prototype.scrollMaxTop=function(){return this.scrollHeight()-this.$content.height()},this.Control.prototype.scrollLeft=function(n){return this.enabled&&!isNaN(n)&&this.$scroller.prop("scrollLeft",n),this.$scroller.prop("scrollLeft")},this.Control.prototype.scrollTop=function(n){return this.enabled&&!isNaN(n)&&this.$scroller.prop("scrollTop",n),this.$scroller.prop("scrollTop")},this.Control.prototype.redraw=function(){c.call(this,n.VERTICAL),c.call(this,n.HORIZONTAL),s.call(this)}}),atom.controls.Slider=atom.controls.register(new function(){function u(n,t){return t?t.indexOf("this::")==0?n.find(t.replace(/^this::/,atom.string.EMPTY)):$(t):null}function f(n){var u,f;if(n.$element.is(":visible")){u=n.$element[n.props.size](),f=n.$handle[n.props.outerSize](),n.minPos=0,n.maxPos=u-f;var t=n.settings.minValue,i=n.settings.maxValue,r=i-t;t<0&&i>0&&(r=i+Math.abs(t)),n.ratio=r/n.maxPos,n.range=r,n.ready||(n.value(n._value),n.ready=!0)}}function o(t){atom.drag.on("move",this.onDragMove);atom.drag.on("stop",this.onDragEnd);var i={moveX:this.settings.orientation==n.HORIZONTAL,moveY:this.settings.orientation==n.VERTICAL,minX:this.minPos,maxX:this.maxPos,minY:this.minPos,maxY:this.maxPos};return atom.drag.start(t,this.$handle,i),!1}function s(){r(this),this.fireEvent("change")}function h(){atom.drag.off("move",this.onDragMove),atom.drag.off("stop",this.onDragEnd)}function r(n){if(n.$text||n.$control){var t=n.value();n.$text&&n.$text.text(t),n.$control&&n.$control.val(t)}}var t=this,n={HORIZONTAL:0,VERTICAL:1},i={NORMAL:0,INVERTED:1},e={"0":{pos:"left",min:"minX",max:"maxX",size:"width",outerSize:"outerWidth"},"1":{pos:"top",min:"minY",max:"maxY",size:"height",outerSize:"outerHeight"}};this.NAME="atom.controls.Slider",this.async=!1,this.expression=".slider",this.setup=function(){$(window).on("resize",this.redraw)},this.Settings=atom.Settings.extend(function(t,r){this.orientation=$(t).hasClass("vertical")?n.VERTICAL:n.HORIZONTAL,this.layout=this.orientation==n.VERTICAL?i.INVERTED:i.NORMAL,this.roundValues=this.getBoolean("roundValues",t,r,!0),this.minValue=this.getNumber("minValue",t,r,0),this.maxValue=this.getNumber("maxValue",t,r,100),this.value=this.getNumber("value",t,r),this.defaultValue=this.getNumber("defaultValue",t,r,this.minValue),this.textElement=this.getString("textElement",t,r,atom.string.EMPTY).trim(),this.controlElement=this.getString("controlElement",t,r,atom.string.EMPTY).trim(),this.maxValue<this.minValue&&(this.maxValue=this.minValue)}),this.Control=atom.HtmlControl.extend(function(n,i){this.construct(n,"change","reset"),this.settings=new t.Settings(n,i),this.props=e[this.settings.orientation],this.ready=!1,this.$handle=$("<div class='handle'/>"),this.$element.html(atom.string.EMPTY),this.$element.append(this.$handle),this.$text=u(this.$element,this.settings.textElement),this.$control=u(this.$element,this.settings.controlElement);this.$handle.on("mousedown",$.proxy(o,this));this.$handle.on("dblclick",$.proxy(this.reset,this));this.onDragMove=$.proxy(s,this),this.onDragEnd=$.proxy(h,this),this.minPos=0,this.maxPos=0,this.ratio=0,f(this),r(this,!0),this.initValue=parseFloat(this.$element.attr("data-value"))||0,this.value(this.initValue),t.registerInstance(this)}),this.Control.prototype.reset=function(){this.value(this.settings.defaultValue)},this.Control.prototype.value=function(n){var t,f,e,o,u;return this.$element.is(":visible")?(t=parseInt(this.$handle.css(this.props.pos)),f=this.settings.layout==i.INVERTED?this.settings.minValue+(this.maxPos-t)*this.ratio:this.settings.minValue+t*this.ratio,atom.type.isNumeric(n)?(e=Math.max(Math.min(parseFloat(n),this.settings.maxValue),this.settings.minValue),o=e!=this._value,this._value=e,this._value!=f&&(u=this._value-this.settings.minValue,u=this.settings.layout==i.INVERTED?this.maxPos-u:u,t=Math.round(u/this.ratio),this.$handle.css(this.props.pos,t)),r(this),o&&this.fireEvent("change")):this._value=f,this.settings.roundValues&&(this._value=Math.round(this._value)),this._value):(n&&(this._value=n),this._value!=null?this._value:this.initValue)},this.redraw=function(){for(var n=0;n<t.instances.length;n++)f(t.instances[n])}}),atom.controls.FlexStrip=atom.controls.register(new function(){function r(n){var i,f,r;if(n<0&&this.autoIndex==this.$slides.length-1||n>0&&this.autoIndex==0)return this.autoIndex;var u=Number.POSITIVE_INFINITY,t=-1,e=parseInt(this.$element.css(this.props.position))||0;for(i=0;i<this.$slides.length;i++)f=this.snapCoords[i],r=Math.abs(e+f),r<u&&(u=r,t=i);return n>0&&t>=this.autoIndex&&(t=this.autoIndex-1),n<0&&t<=this.autoIndex&&(t=this.autoIndex+1),t}function w(){for(var i=[],t=0,r,o=parseInt(this.$element.css(this.props.paddingStart)),e,n=0;n<this.$slides.length;n++){var u=this.$slides.eq(n),s=u.prop(this.props.offsetPos),h=parseInt(u.css(this.props.marginStart))||0,c=u.width();r=s-(o+h),i.push(r),t=r+c}if(t<this.stripLength){var l=this.stripLength-t,f=Math.ceil(l/this.containerLength),a=this.stripLength-this.containerLength;for(n=0;n<f;n++)e=t+n*f,i.push(Math.max(e,a))}return i}function s(n){for(var i=Number.MAX_VALUE,r,t=0;t<this.snapCoords.length;t++)r=-this.snapCoords[t],Math.abs(r-n)<i-n&&(i=r);return i}function t(n){var t={top:parseInt(this.$element.css("top"))||0,left:parseInt(this.$element.css("left"))||0};return t.right=t.left+this.$element.width(),t.bottom=t.top+this.$element.height(),n?t[n]:t}function u(n){var t=this[this.props.minPos],i=this[this.props.maxPos];return Math.min(Math.max(n,t),i)}function b(n){var u,f=n.originalEvent||n,t=f.detail,i=f.wheelDelta,r=225,e=r-1;return t=t?i&&(u=i/t)?t/u:-t/.15:i/120,t=t<1?t<-1?(-Math.pow(t,2)-e)/r:t:(Math.pow(t,2)+e)/r,Math.min(Math.max(t/2,-1),1)}function k(){var t=parseInt(this.$element.css(this.props.position)),n,i,r;if(this.wasThrown=t>=this[this.props.minPos]&&t<=this[this.props.maxPos],n=t+8*this.accel,i=s.call(this,n),Math.abs(i-n)<=this.settings.snapDistance&&(n=i),this.wasThrown||(n=u.call(this,n)),t==n){v.call(this);return}r={},r[this.props.position]=n,this.$element.velocity("stop"),this.$element.velocity(r,this.animSettings)}function i(n,t){var r={},u=-this.snapCoords[n],i;if(r[this.props.position]=u,this.autoIndex=n,this.selectedIndex=n,t&&parseInt(this.$element.css(this.props.position))==u){this.fireEvent("select");return}i=this,this.$element.velocity("stop"),this.$element.velocity(r,$.extend({},this.animSettings,{complete:function(){i.animSettings.complete.apply(i,arguments),t&&i.fireEvent("select")}}))}function f(n){if(!this.slidesFrozen){var t=this.slideIndex(),r=t==0?0:t-1;i.call(this,r,n)}}function e(n){if(!this.slidesFrozen){var t=this.slideIndex(),r=t==this.snapCoords.length-1?t:t+1;i.call(this,r,n)}}function h(n){if(!atom.dom.isTouchDevice()&&this.settings.arrowsOnHover)if(n||!this.mouseWithinRange)this.$arrowBack.removeClass("visible"),this.$arrowNext.removeClass("visible");else{if(this.slidesFrozen)return;var i=t.call(this)[this.props.position];this.$arrowBack.toggleClass("visible",i<this.maxX),this.$arrowNext.toggleClass("visible",i>this.minX)}}function c(n){n=n.originalEvent||n;var i=$(document),r=this.$container.offset(),t={eventX:n.pageX||n.clientX||0,eventY:n.pageY||n.clientY||0};return n.touches&&n.touches.length&&(t.eventX=n.touches[0].clientX,t.eventY=n.touches[0].clientY,t.touches=n.touches),t.mouseX=t.eventX-r.left+i.scrollLeft(),t.mouseY=t.eventY-r.top+i.scrollTop(),t.inRange=t.mouseX>=this.minMouseX&&t.mouseX<=this.maxMouseX&&t.mouseY>=this.minMouseY&&t.mouseY<=this.maxMouseY,t}function d(){var n=this.$element.position()[this.props.position],t;(n<this[this.props.minPos]||n>this[this.props.maxPos])&&(this.wasCancelled=!0,t={},t[this.props.position]=n<this[this.props.minPos]?this[this.props.minPos]:this[this.props.maxPos],this.$element.velocity("stop"),this.$element.velocity(t,$.extend({},this.animSettings,{duration:this.settings.animDuration/2})))}function g(){var n,t,i;return this.settings.snapToItems?(n=this.$element.position()[this.props.position],t=s.call(this,n),Math.abs(t-n)<=this.settings.snapDistance)?(this.move!=null&&(this.move.kill(),this.move=null),this.wasCancelled=!0,i={},i[this.props.position]=t,this.$element.velocity(i,$.extend({},this.animSettings,{duration:this.settings.animDuration/2})),!0):!1:!1}function nt(){this.animEngaged=!0}function tt(n,t){var i,u;(t&&(t.end=this.targetPos),i=parseInt(this.$element.css(this.props.position)),this.autoIndex=r.call(this,0),this.fireEvent("move",{atStart:i==this[this.props.maxPos],atEnd:i==this[this.props.minPos]}),this.wasCancelled)||(this.wasThrown||this.wasScrolled)&&(u=g.call(this),u||d.call(this))}function v(){this.targetDir=0,this.animEngaged=!1,this.wasThrown=!1,this.wasScrolled=!1,this.wasCancelled=!1;var n=parseInt(this.$element.css(this.props.position));this.fireEvent("stop",{position:n,atStart:n==this[this.props.maxPos],atEnd:n==this[this.props.minPos]}),h.call(this)}function it(n){var i,u;if(this.dragMode||this.scrollMode||(i=this.$container[this.props.outerSize](),i==0))return!0;var s=$("html"),a=this.$container.offset(),r=c.call(this,n);if(this.mouseWithinRange=this.stripLength>i&&r.inRange,this.mouseWithinRange&&this.settings.autoScroll){var f=this.settings.vertical?r.mouseY:r.mouseX,t=Math.round(-(f*this.ratio)+this.settings.extraLength),e=parseInt(this.$element.css(this.props.position)),o=Math.abs(e-t)>l;this.targetPos=t,this.settings.useAnimations&&o&&!this.animEngaged&&(u={},u[this.props.position]=t,this.$element.velocity("stop"),this.$element.stop().animate(u,this.animSettings)),this.settings.useAnimations&&this.animEngaged||this.$element.css(this.props.position,t)}return h.call(this),!0}function rt(n){return f.call(this),n.stopPropagation(),!1}function ut(n){return e.call(this),n.stopPropagation(),!1}function ft(n){var t,u,r;if(this.dragMode||this.scrollMode||n.type=="mouseup"&&n.which!=1)return!0;for(t=$(n.target);!t.parent().is(this.$element);)if(t=t.parent(),t.length==0)return!0;return(u=this.$slides.index(t),this.settings.scrollOnClick)?(i.call(this,u,!0),!1):(r=atom.event.create(this,"select"),this.fireEvent(r),r.cancel!==!0)}function et(){return!this.dragMode&&!this.scrollMode}function ot(n){var c,l,r,v,a,s;if(!this.settings.mouseDraggable||!this.mouseWithinRange||this.transitioning||this.slidesFrozen)return!0;var h=n.originalEvent||n,i=-h.wheelDelta||h.detail,o=t.call(this,this.props.position);if(!(i>0)||o!=this[this.props.minPos])return i<0&&o==this[this.props.maxPos]?void 0:(this.settings.forceSnapPoints?i>0?e.call(this):i<0&&f.call(this):(c=h.wheelDelta!=null,l=b(n),this.accel=c?l*4:i,r=c?u.call(this,o+l*this.scrollMoveSize):u.call(this,o-i*(this.scrollMoveSize/25)),this.animEngaged&&this.targetDir!=0&&(this.targetDir==-1&&r<this.targetPos&&(r=this.targetPos),this.targetDir==1&&r>this.targetPos&&(r=this.targetPos)),this.targetPos=r,this.targetDir=i>0?1:-1,this.wheelAccellerationOn&&(this.wheelAnimActive&&(this.wheelMultiplier!=1&&this.wheelDirection!=this.targetDir&&(this.wheelMultiplier=1),this.wheelMultiplier+=.05,this.wheelDirection=this.targetDir),v=this.targetPos*this.wheelMultiplier-this.targetPos,this.targetPos=u.call(this,this.targetPos+this.targetDir*v)),a={},a[this.props.position]=this.targetPos,s=this,this.wasScrolled=!0,this.wheelAnimActive=!0,this.$element.velocity("stop"),this.$element.velocity(a,$.extend({},this.animSettings,{complete:function(){s.wheelAnimActive=!1,s.wheelMultiplier=1,s.animSettings.complete.apply(this,arguments)}}))),atom.event.cancel(n),!1)}function st(){this.redraw(!0)}function ht(n){if(n.target.tagName.match(/^textarea|select$/i)||n.target.tagName=="INPUT"&&!n.target.type.match(/^checkbox|radio|button|submit|reset$/i))return!0;if(this.settings.globalKeyReact||this.mouseWithinRange){if(this.settings.vertical){if(n.keyCode==atom.const.Key.UP)return f.call(this),!1;if(n.keyCode==atom.const.Key.DOWN)return e.call(this),!1}else{if(n.keyCode==atom.const.Key.LEFT)return f.call(this),!1;if(n.keyCode==atom.const.Key.RIGHT)return e.call(this),!1}return!0}}function ct(n){var i,r;return this.settings.mouseDraggable?n.type=="mousedown"&&n.which!=1?!0:this.stripLength<=this.containerLength?!0:(i=c.call(this,n),atom.dom.isTouchDevice()&&i.touches&&i.touches.length!=1)?!0:(this.animEngaged&&this.$element.stop(),this.dragMode=!1,this.scrollMode=!1,this.startPos=t.call(this,this.props.position),r=$(document),this.startScrollX=r.scrollLeft(),this.startScrollY=r.scrollTop(),console.log("start pos y: "+this.startPosY),this.startEventX=i.eventX,this.startEventY=i.eventY,this.startEventPos=i[this.props.eventPos],document.addEventListener(atom.dom.mouseUpEvent,this.elementDragEndListener,!0),document.addEventListener(atom.dom.mouseMoveEvent,this.elementDragMoveListener,!0),atom.event.cancel(n)):!0}function lt(n){var o=c.call(this,n),w,b,f,e,h,g,nt;if(this.settings.dropOnMouseOut&&!o.inRange&&!this.scrollMode)return y.call(this,n),!0;this.move!=null&&(this.move.kill(),this.move=null);var tt=o.eventX,it=o.eventY,a=tt-this.startEventX,v=it-this.startEventY,u=this.settings.vertical?v:a,p=this.settings.vertical?a:v;if(!this.dragMode&&Math.abs(p)>=l&&(this.scrollMode=!0),this.scrollMode)return w=this.settings.vertical?this.startScrollX:this.startScrollY,b=this.settings.vertical?"scrollLeft":"scrollTop",$(document)[b](w-p),!0;var k=this[this.props.minPos],d=this[this.props.maxPos],i=this.startPos+u;return i>d?(f=i-d,e=Math.max(0,1-f/(this.containerLength*2)),u=Math.round(u*e),i=Math.round(this.startPos+u)):i<k&&(f=k-i,e=Math.max(.5,1-f/(this.containerLength*2)),u=Math.round(u*e),i=Math.round(this.startPos+u)),this.settings.snapToItems&&(h=s.call(this,i),Math.abs(h-i)<=this.settings.snapDistance&&(i=h)),g=t.call(this,this.props.position),this.$element.css(this.props.position,i),nt=t.call(this,this.props.position),this.accel=(nt-g)*1.5,this.accel!=0&&(this.dragMode=!0),this.autoIndex=r.call(this,0),this.fireEvent("move"),atom.event.cancel(n)}function y(){var n,t;this.dragMode&&(this.settings.forceSnapPoints?(n=r.call(this,this.accel,!0),i.call(this,n)):k.call(this)),document.removeEventListener(atom.dom.mouseUpEvent,this.elementDragEndListener,!0),document.removeEventListener(atom.dom.mouseMoveEvent,this.elementDragMoveListener,!0),t=this,setTimeout(function(){t.dragMode=!1},1)}function at(n){return this.settings.mouseDraggable&&this.dragMode?atom.event.cancel(n):!0}var l=10,p=400,a={VERTICAL:{scrollSize:"scrollHeight",outerSize:"outerHeight",size:"height",position:"top",offsetPos:"offsetTop",minPos:"minY",maxPos:"maxY",paddingStart:"paddingTop",paddingEnd:"paddingBottom",marginStart:"marginTop",eventPos:"eventY",startEventPos:"startEventY"},HORIZONTAL:{scrollSize:"scrollWidth",outerSize:"outerWidth",size:"width",position:"left",offsetPos:"offsetLeft",minPos:"minX",maxPos:"maxX",paddingStart:"paddingLeft",paddingEnd:"paddingRight",marginStart:"marginLeft",eventPos:"eventX",startEventPos:"startEventX"}},n={FREE:"free",SLIDE:"slide",PAGE:"page"},o=this;this.NAME="atom.controls.FlexStrip",this.async=!1,this.expression=".flexstrip",this.setup=function(){$(window).on("resize",this.redraw)},this.redraw=function(){for(var n=0;n<o.instances.length;n++)o.instances[n].redraw()},this.Settings=atom.Settings.extend(function(t,i){this.mode=this.getString("mode",t,i,n.FREE,n),this.extraLength=this.getNumber("extraLength",t,i,0),this.useAnimations=this.getBoolean("useAnimations",t,i,!0),this.mouseDraggable=this.getBoolean("mouseDraggable",t,i,!0),this.pageMode=this.getBoolean("pageMode",t,i,!1),this.dropOnMouseOut=this.getBoolean("dropOnMouseOut",t,i,!0),this.autoScroll=this.getBoolean("autoScroll",t,i,!1),this.snapToItems=this.getBoolean("snapToItems",t,i,!1),this.snapDistance=this.getNumber("snapDistance",t,i,35),this.forceSnapPoints=this.getBoolean("forceSnapPoints",t,i,!1),this.scrollOnClick=this.getBoolean("scrollOnClick",t,i,!1),this.arrowsOnHover=this.getBoolean("arrowsOnHover",t,i,!1),this.animDuration=this.getNumber("animDuration",t,i,p),this.globalKeyReact=this.getBoolean("globalKeyReact",t,i,!1),this.vertical=this.getBoolean("vertical",t,i,!1),this.center=this.getBoolean("center",t,i,!1),this.stretch=this.getBoolean("stretch",t,i,!1),this.consolidate()}),this.Settings.prototype.consolidate=function(){switch(this.mode){case n.PAGE:this.autoScroll=!1,this.snapToItems=!0,this.forceSnapPoints=!0;break;case n.SLIDE:this.forceSnapPoints=!0,this.autoScroll=!1}},this.Control=atom.HtmlControl.extend(function(n,t){this.construct("move","stop","select"),this.settings=new o.Settings(n,t),this.$element=$(n),this.$slides=this.$element.find("> *"),this.$container=this.$element.parent(),this.props=this.settings.vertical?a.VERTICAL:a.HORIZONTAL,this.$element.css({position:"relative",overflow:"hidden"}),this.settings.vertical?this.$element.addClass("vertical"):this.$element.css({whiteSpace:"nowrap"}),this.mouseWithinRange=!1,this.animEngaged=!1,this.dragMode=!1,this.scrollMode=!1,this.transitioning=!1,this.stripLength=0,this.autoIndex=0,this.selectedIndex=0,this.scrollMoveSize=0,this.slidesFrozen=!1,this.startPos=0,this.startEventX=0,this.startEventY=0,this.minMouseX=0,this.minMouseY=0,this.maxMouseX=this.$container.outerWidth(),this.maxMouseY=this.$container.outerHeight(),this.initPos=this.$element.position()[this.props.position],this.targetPos=0,this.targetDir=0,this.wheelMultiplier=1,this.wheelAnimActive=!1,this.wheelDirection=0,this.wheelAccellerationOn=!0,this.animSettings={easing:"easeOutExpo",step:$.proxy(tt,this),start:$.proxy(nt,this),complete:$.proxy(v,this),duration:this.settings.animDuration};this.$element.on(atom.dom.mouseDownEvent,$.proxy(ct,this));this.$element.on(atom.dom.mouseUpEvent,$.proxy(at,this));this.$slides.on(atom.dom.mouseUpEvent,$.proxy(ft,this));this.$slides.on("click",$.proxy(et,this));this.$container.on("mousewheel DOMMouseScroll",$.proxy(ot,this));this.elementDragEndListener=$.proxy(y,this),this.elementDragMoveListener=$.proxy(lt,this);$(document).on("keydown",$.proxy(ht,this));$(window).on("resize",$.proxy(st,this));$(document).on(atom.dom.mouseMoveEvent,$.proxy(it,this));this.$arrowBack=$('<div class="flexstrip-arrow prev {0}"><\/div>'.format(this.settings.vertical?"vertical":"")).appendTo(this.$container),this.$arrowNext=$('<div class="flexstrip-arrow next {0}"><\/div>'.format(this.settings.vertical?"vertical":"")).appendTo(this.$container);this.$arrowBack.on("click",$.proxy(rt,this));this.$arrowNext.on("click",$.proxy(ut,this));this.redraw(),this.$element.addClass("ready")}),this.Control.prototype.redraw=function(t){var i=this.$container[this.props.size](),u,f,s,e,h,c,o;if(i!=0){for(u=(parseInt(this.$element.css(this.props.paddingStart))||0)+(parseInt(this.$element.css(this.props.paddingEnd))||0),this.$slides=this.$element.find("> *"),this.settings.mode==n.PAGE&&this.$slides[this.props.size](i),f=0;f<this.$slides.length;f++)s=this.$slides.eq(f),u+=s[this.props.outerSize](!0);if(this.minMouseX=0,this.minMouseY=0,this.maxMouseX=this.$container.outerWidth(),this.maxMouseY=this.$container.outerHeight(),this.containerLength=i,this.stripLength=u+this.initPos+this.settings.extraLength*2,e=u-i,this.ratio=e/i,this.scrollMoveSize=Math.min(this.$slides.eq(0).outerWidth(!0),this.$slides.eq(0).outerHeight(!0)),this.maxX=this.maxY=0,this.minX=this.minY=-e,this.settings.mode==n.SLIDE&&(h=this.$slides.eq(this.$slides.length-1),this.minX=this.minY=-this.stripLength+h[this.props.size]()),this.$element.css(this.props.size,Math.ceil(u)+1),this.snapCoords=w.call(this),u<i)this.$element.css(this.props.position,0),this.settings.stretch&&(this.$element.css(this.props.size,i),this.$element.css(this.props.position,0),u=i),this.settings.center&&(c=Math.round(i/2-u/2),this.$element.css(this.props.position,c));else{o=parseInt(this.$element.css(this.props.position))||0,t&&(o=-this.snapCoords[this.slideIndex()]);var l=this[this.props.minPos],a=this[this.props.maxPos],v=Math.min(Math.max(o,l),a);this.$element.css(this.props.position,v),this.autoIndex=r.call(this,0)}}},this.Control.prototype.set=function(n,t){this.base("set",n,t),this.settings.consolidate()},this.Control.prototype.prev=function(){return this.select(this.selectedIndex-1)},this.Control.prototype.next=function(){return this.select(this.selectedIndex+1)},this.Control.prototype.select=function(n){return n>=0&&n<this.$slides.length?(i.call(this,n,!1),!0):!1},this.Control.prototype.slideIndex=function(){return this.transitioning?this.selectedIndex:this.autoIndex},this.Control.prototype.hideArrows=function(){h.call(this,!0)}}),atom.controls.Tooltip=atom.controls.register(new function(){function i(t,r,u){var e={orientation:t,arrow:{left:0,top:0}},c=t.match(/T|B/)!=null,o="B",h;switch(t){case"T":o="B";break;case"B":o="T";break;case"L":o="R";break;case"R":o="L"}var f=c?atom.HtmlControl.PROPS.VERTICAL:atom.HtmlControl.PROPS.HORIZONTAL,l=f.position=="top"?"bottom":"right",a=this.settings.showArrow?n.$arrow[f.size]():0;c&&(a/=2);var y=this.$element.offset(),p=$(n.document)[f.scrollPos](),v=n.offset[f.position]+y[f.position]-p,s=n.$popup[f.outerSize]()+a,w=this.$element[f.outerSize]();return(t.match(/T|L/)?(e[f.position]=v-s-this.settings.offset,e.arrow[f.position]="auto",e.arrow[l]=0):(e[f.position]=v+w+this.settings.offset,e.arrow[f.position]=0,e.arrow[l]="auto"),h=s>u-r,!h&&e[f.position]<r)?i.call(this,o,r,u):!h&&e[f.position]+s>u?i.call(this,o,r,u):e}function r(t,i,u,f){var e={orientation:i,arrow:{left:1,top:1}},l=i.match(/T|B/)!=null,s,c;i=="C"&&(l=t.match(/L|R/)!=null),s="B";switch(i){case"T":s="B";break;case"B":s="T";break;case"L":s="R";break;case"R":s="L";break;default:s=l?"B":"R"}var o=l?atom.HtmlControl.PROPS.VERTICAL:atom.HtmlControl.PROPS.HORIZONTAL,v=this.settings.showArrow?n.$arrow[o.size]():0,p=this.$element.offset(),w=$(n.document)[o.scrollPos](),a=n.offset[o.position]+p[o.position]-w,h=n.$popup[o.outerSize](),y=this.$element[o.outerSize]();return(i.match(/T|L/)?(e[o.position]=a,e.arrow[o.position]=this.settings.arrowOffset):i.match(/B|R/)?(e[o.position]=a+y-h,e.arrow[o.position]=h-v-this.settings.arrowOffset):(e[o.position]=a+(y/2-h/2),e.arrow[o.position]=h/2-v/2),e.oversized=h>f-u,e.beyondFirstEdge=e[o.position]<u,e.beyondSecondEdge=e[o.position]+h>f,e.orientationRev=s,!e.oversized&&arguments.callee.caller!=arguments.callee&&(e.beyondFirstEdge||e.beyondSecondEdge))?(c=r.call(this,t,s,u,f),i=="C"&&(c.beyondFirstEdge||c.beyondSecondEdge)&&(c=r.call(this,t,c.orientationRev,u,f)),c):e}function h(){window.clearTimeout(t)}function c(){this.hideTooltip()}function l(){(window.clearTimeout(t),!n.instance||n.instance==this||n.instance.settings.hideOn.contains("mouseout"))&&this.settings.showOn.contains("mouseover")&&(this.$element.hasClass("tooltip-suspend")||(this.settings.showDelay>0?t=window.setTimeout(this.showTooltip,this.settings.showDelay):this.showTooltip()))}function a(){(window.clearTimeout(t),n.instance==this)&&this.settings.hideOn.contains("mouseout")&&(this.settings.hideDelay>0?t=window.setTimeout(this.hideTooltip,this.settings.hideDelay):this.hideTooltip())}function v(){this.settings.showOn.contains("focus")&&this.show()}function y(){this.settings.hideOn.contains("blur")&&this.hide()}function o(){n.$popup.is(":visible")&&this.settings.hideOn.contains("click")?this.hide():!n.$popup.is(":visible")&&this.settings.showOn.contains("click")&&this.show()}function p(t){n.$popup.is(":visible")&&n.instance==this&&(jQuery.contains(this.$element[0],t.target)||jQuery.contains(n.$popup[0],t.target)||this.hide())}function w(){this.hide()}function b(t){return this.each(function(i,r){new n.Control(r,t)})}function s(){var u,i,r,f,t;n.offset.top=0,n.offset.left=0,u=!1;try{n.document=top.document}catch(e){n.document=document,u=!0}if(!u&&(i=window,window!=window.parent))while(i!=top)for(i=i.parent,r=$("iframe, frame",i.document),f=!1,t=0;t<r.length;t++)if(r[t].contentWindow==window){n.offset.left+=r.eq(t).offset().left,n.offset.top+=r.eq(t).offset().top,f=!0;break}}function k(){var s=$(n.document.getElementById(e)),h,u,f,o,t,c;if(s.length!=0)n.$popup=s;else if(h=atom.string.format('<div class="atomtooltippopup" id="{0}"><div class="arrow"><\/div><div class="bg"><\/div><div class="content"><\/div><\/div>',e),n.$popup=$(h),$(n.document.body).append(n.$popup),n.document!=document){for(u=$("<style id='tooltipStyles'><\/style>"),$(n.document.body).append(u),f=[],o=atom.css.findRules(".atomtooltippopup"),t=0;t<o.length;t++)c=o[t],f.push(c.css.cssText);u.html(f.join("\n"))}n.$content=n.$popup.find(".content"),n.$arrow=n.$popup.find(".arrow");var i=n.$arrow.width(),r=n.$arrow.height(),l=$('<canvas class="b" width="{0}" height="{1}"/>'.format(i,r/2)).appendTo(n.$arrow)[0],a=$('<canvas class="t" width="{0}" height="{1}"/>'.format(i,r/2)).appendTo(n.$arrow)[0],v=$('<canvas class="l" width="{0}" height="{1}"/>'.format(i/2,r)).appendTo(n.$arrow)[0],y=$('<canvas class="r" width="{0}" height="{1}"/>'.format(i/2,r)).appendTo(n.$arrow)[0];n.cB=l,n.cT=a,n.cL=v,n.cR=y}function u(t){var i=n.$arrow.width(),r=n.$arrow.height(),s=n.$popup.find(".bg"),u=s.css("border-bottom-color"),e=parseInt(s.css("border-bottom-width")),o=s.css("background-color");switch(t){case"L":f(n.cL,o,u,e,function(n){n.moveTo(i/2,0),n.lineTo(0,r/2),n.lineTo(i/2,r)});break;case"R":f(n.cR,o,u,e,function(n){n.moveTo(0,0),n.lineTo(i/2,r/2),n.lineTo(0,r)});break;case"B":f(n.cB,o,u,e,function(n){n.moveTo(0,0),n.lineTo(i/2,r/2),n.lineTo(i,0)});break;case"T":f(n.cT,o,u,e,function(n){n.moveTo(0,r/2),n.lineTo(i/2,0),n.lineTo(i,r/2)})}}function f(n,t,i,r,u){var f=n.getContext("2d");f.clearRect(0,0,n.width,n.height),f.fillStyle=t,f.strokeStyle=i,f.lineWidth=r,f.beginPath(),u(f),f.fill(),r&&f.stroke()}var e="tooltip_popup",t,n=this;return n.instance=null,n.$popup=null,n.$arrow=null,n.document=null,n.$content=null,n.offset={left:0,top:0},n.NAME="atom.controls.Tooltip",n.async=!1,n.expression=".tooltip",n.setup=function(){n.$popup==null&&(s(),k(),$.fn.tooltip=b,$(window).resize(s))},n.Settings=atom.Settings.extend(function(n,t){this.construct(n,t),this.className=this.getString("className",n,t,null),this.followMouse=this.getBoolean("followMouse",n,t,!0),this.maxWidth=this.getString("maxWidth",n,t,null),this.showOn=this.getString("showOn",n,t,"mouseover").split(/(?:\s*,\s*)|(?:\s+)/),this.hideOn=this.getString("hideOn",n,t,"mouseout").split(/(?:\s*,\s*)|(?:\s+)/),this.orientation=this.getString("orientation",n,t,"TC").toUpperCase(),this.offset=this.getNumber("offset",n,t,3),this.showDelay=this.getNumber("show-delay",n,t,200),this.hideDelay=this.getNumber("hide-delay",n,t,0),this.obscureOnly=this.getBoolean("obscureOnly",n,t,!1),this.useFades=this.getBoolean("useFades",n,t,!1),this.showArrow=this.getBoolean("showArrow",n,t,!0),this.arrowOffset=this.getNumber("arrow-offset",n,t,5),this.content=this.getString("content",n,t,null)}),n.Control=atom.HtmlControl.extend(function(t,i){this.construct(t),this.settings=new n.Settings(t,i),this.$element.bind("mouseenter",$.proxy(l,this)).bind("mouseleave",$.proxy(a,this)).bind("focus",$.proxy(v,this)).bind("blur",$.proxy(y,this)).bind("click",$.proxy(o,this));var r=this.settings.content?this.$element.find(this.settings.content).html():this.$element.data("tooltip")||this.$element.attr("title")||this.$element.attr("data-title");this.$element.data("tooltip",r),this.$element.attr("data-title",r),this.$element.attr("title",atom.string.EMPTY),this.showTooltip=$.proxy(this.show,this),this.hideTooltip=$.proxy(this.hide,this);$(n.document).on("keydown click",$.proxy(p,this)).on("scroll",$.proxy(w,this));n.$popup.on("click",$.proxy(o,this)).on("mouseenter",$.proxy(h,this)).on("mouseleave",$.proxy(c,this));n.registerInstance(this)}),n.Control.prototype.hide=function(){n.$popup.hide(),n.$popup.removeClass(n.$popup.attr("class-added")),n.instance=null},n.Control.prototype.show=function(){var s,c,t,f,e;if(!this.$element.hasClass("tooltip-suspend")&&!this.$element.hasClass("disabled")&&(!this.settings.obscureOnly||(s=this.$element[0],!(s.scrollWidth<=s.offsetWidth)||!(s.scrollHeight<=s.offsetHeight)))&&(c=this.$element.data("tooltip"),c)){n.$content.html(c);var h=this.settings.orientation,o=h[0].match(/T|L|R|B/)?h[0]:"T",l=h[1].match(/T|L|R|B|C/)?h[1]:"L",a=$("html",n.document)[0],v=$("body",n.document)[0],y=a.offsetWidth||v.offsetWidth,p=a.offsetHeight||v.offsetHeight;if(n.$popup.css({left:0,top:-1e3,display:"block"}).removeClass("t l r b -t -l -r -b"),n.$popup.addClass(this.settings.className).attr("class-added",this.settings.className),n.$arrow.toggle(this.settings.showArrow),o.match(/T|B/)?(t=i.call(this,o,0,p),f=r.call(this,o,l,0,y),e={popupLeft:f.left,popupTop:t.top,arrowLeft:f.arrow.left,arrowTop:t.arrow.top,orientation:t.orientation,orientationS:f.orientation}):(t=i.call(this,o,0,y),f=r.call(this,o,l,0,p),e={popupLeft:t.left,popupTop:f.top,arrowLeft:t.arrow.left,arrowTop:f.arrow.top,orientation:t.orientation,orientationS:f.orientation}),n.$popup.css({left:e.popupLeft,top:e.popupTop}),n.$arrow.css({left:e.arrowLeft,top:e.arrowTop}),this.settings.showArrow)switch(o){case"T":u.call(this,"B");break;case"B":u.call(this,"T");break;case"L":u.call(this,"R");break;case"R":u.call(this,"L")}n.$popup.addClass(e.orientation.toLowerCase()),n.$popup.addClass("-"+e.orientationS.toLowerCase()),n.instance=this,n.$popup.css({display:"block",opacity:1})}},n.Control.prototype.set=function(n,t){return t&&(n=="showOn"||n=="hideOn")&&(t=t.split(/(?:\s*,\s*)|(?:\s+)/)),this.settings[n]!=undefined&&(this.settings[n]=t),this.settings[n]},n})