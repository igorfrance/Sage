atom.controls.Scroller=atom.controls.register(new function(){function r(n){var f=n.$scroller.prop(n.props.scrollSize),t=n.$scroller[n.props.size](),e=n.$track[n.props.size](),i=n.$grip[n.props.size](),r;f>t?(n.settings.sizing==u.PROPORTIONAL?(r=e-2*n.offset,n.scrollRatio=r/f,i=Math.round(t*n.scrollRatio),n.$grip.css(n.props.size,i)):(r=f-t,n.scrollRatio=(t-i)/r),n.minScroll=n.offset,n.maxScroll=e-i-n.offset,n.enabled&&n.$track.show()):n.$track.hide()}function a(n){atom.drag.on("move",this.onDragMove);atom.drag.on("stop",this.onDragEnd);var t={moveX:this.settings.orientation==i.HORIZONTAL,moveY:this.settings.orientation==i.VERTICAL,minX:this.minScroll,minY:this.minScroll,maxX:this.maxScroll,maxY:this.maxScroll};return atom.drag.start(n,this.$grip,t),this.fireEvent("dragstart"),!1}function v(){tt(this)}function y(){atom.drag.off("move",this.onDragMove),atom.drag.off("stop",this.onDragEnd),this.fireEvent("dragend")}function p(){h(this,"ENGAGED",!0),e(this),this.fireEvent("scroll")}function w(){h(this,"HOT")}function b(){o(this,"HOT")}function k(i){var r,u;if(this.isScrollable()){for(r=this.$element.parent();r.length!=0;)u=t.get(r),u!=null&&(i.stopPropagation(),r.removeClass(n.ENGAGED),r.removeClass(n.HOVER),r.removeClass(n.HOT)),r=r.parent();this.$element.addClass(n.HOVER),this.$element.addClass(n.HOT),o(this,"HOT")}}function d(){this.isScrollable()&&(this.$element.removeClass(n.ENGAGED),this.$element.removeClass(n.HOT),this.$element.removeClass(n.HOVER))}function g(n){if(this.enabled){var t=-n.originalEvent.wheelDelta/40;s(this,t),e(this)}}function nt(n){if(this.enabled){var t=n.originalEvent.detail;s(this,t),e(this)}}function s(n,t){var i=n.$scroller.prop(n.props.scrollPos),r;n.settings.animate?(t*=3,i+=t*f,r={},r[n.props.scrollPos]=i,n.$scroller.stop().animate(r,{easing:"easeOutExpo"})):(i+=t*f,n.$scroller.prop(n.props.scrollPos,i)),n.fireEvent("scroll")}function tt(n){var t=n.$grip.position()[n.props.position],i=Math.round(t/n.scrollRatio);n.$scroller.prop(n.props.scrollPos,i)}function e(n){var t=n.$scroller.prop(n.props.scrollPos),i=Math.round(t*n.scrollRatio);n.$grip.css(n.props.position,Math.min(Math.max(n.minScroll,i),n.maxScroll))}function h(t,i,r){c(t,i),t.$element.addClass(n[i]),r&&o(t,i,!0)}function it(t,i){t.$element.removeClass(n[i])}function o(n,t){var i=function(){it(n,t)};c(n,t),n.switches[t].id=setTimeout(i,n.switches[t].duration)}function c(n,t){clearTimeout(n.switches[t].id)}var t=this,i={VERTICAL:0,HORIZONTAL:1},u={FIXED:0,PROPORTIONAL:1},f=20,l={"0":{scrollSize:"scrollHeight",scrollPos:"scrollTop",size:"height",position:"top"},"1":{scrollSize:"scrollWidth",scrollPos:"scrollLeft",size:"width",position:"left"}},n={HOVER:"hover",HOT:"hot",ENGAGED:"engaged"};this.NAME="atom.controls.Scroller",this.async=!1,this.expression=".scrollable",this.setup=function(){f=parseInt($("body").css("line-height"))||20;$(window).on("resize",this.redraw)},this.redraw=function(){for(var n=0;n<t.instances.length;n++)r(t.instances[n])},this.Settings=atom.Settings.extend(function(n,t){var r=this.getString("sizing",n,t,"").toLowerCase();this.sizing=r=="fixed"?u.FIXED:u.PROPORTIONAL,this.animate=this.getBoolean("animate",n,t,!0),this.orientation=$(n).hasClass("horizontal")?i.HORIZONTAL:i.VERTICAL}),this.Control=atom.HtmlControl.extend(function(n,u){this.construct(n,"scroll","dragstart","dragend"),this.settings=new t.Settings(n,u),this.props=l[this.settings.orientation],this.$element.html(atom.string.format("<div class='atom-scroller'><div class='atom-scrollcontent'>{0}<\/div><\/div><div class='atom-scrolltrack'><div class='atom-scrollgrip'/><\/div>",this.$element.html())),atom.controls.update(this.$element),this.$scroller=this.$element.find("> .atom-scroller"),this.$content=this.$scroller.find("> .atom-scrollcontent"),this.$track=this.$element.find("> .atom-scrolltrack"),this.$grip=this.$track.find("> .atom-scrollgrip");this.$grip.on("mousedown",$.proxy(a,this));this.$scroller.on("scroll",$.proxy(p,this));if(this.onDragMove=$.proxy(v,this),this.onDragEnd=$.proxy(y,this),this.offset=parseInt(this.$grip.css(this.props.position))||0,this.enabled=!0,this.overflow=this.$scroller.css("overflow"),this.switches={HOT:{id:0,duration:2e3},ENGAGED:{id:0,duration:500}},this.settings.orientation==i.HORIZONTAL){var f=0;this.$content.find("> *").each(function(n,t){f+=$(t).outerWidth(!0)}),this.$content.css("width",f);this.$scroller.on("mousewheel",$.proxy(g,this)).on("DOMMouseScroll",$.proxy(nt,this))}this.$element.on("mouseenter",$.proxy(k,this)).on("mouseleave",$.proxy(d,this));this.$track.on("mouseenter",$.proxy(w,this)).on("mouseleave",$.proxy(b,this));t.registerInstance(this),r(this),this.enable()}),this.Control.prototype.enable=function(){this.enabled=!0,r(this),this.isScrollable()&&(this.$scroller.css("overflow",atom.string.EMPTY),this.$track.show())},this.Control.prototype.disable=function(){this.enabled=!1,this.$track.hide(),this.$scroller.css("overflow","hidden")},this.Control.prototype.isScrollable=function(){var n=this.$scroller.prop(this.props.scrollSize),t=this.$scroller[this.props.size]();return n>t},this.Control.prototype.scrollLeft=function(n){return!isNaN(n)&&n>=0&&this.$scroller.prop("scrollLeft",n),this.$scroller.prop("scrollLeft")},this.Control.prototype.scrollTop=function(n){return!isNaN(n)&&n>=0&&this.$scroller.prop("scrollTop",n),this.$scroller.prop("scrollTop")},this.Control.prototype.scrollSize=function(n){return!isNaN(n)&&n>0&&(this.$content.css(this.props.size,n),r(this)),this.$content.prop(this.props.scrollSize)},this.Control.prototype.scrollMax=function(){return this.scrollSize()-this.$content[this.props.size]()},this.Control.prototype.scrollPos=function(n){return this.enabled&&!isNaN(n)&&this.$scroller.prop(this.props.scrollPos,n),this.$scroller.prop(this.props.scrollPos)}}),atom.controls.Slider=atom.controls.register(new function(){function u(n,t){return t?t.indexOf("this::")==0?n.find(t.replace(/^this::/,atom.string.EMPTY)):$(t):null}function f(n){var f,e;if(n.$element.is(":visible")){f=n.$element[n.props.size](),e=n.$handle[n.props.outerSize](),n.minPos=0,n.maxPos=f-e;var i=n.settings.minValue,r=n.settings.maxValue,u=r-i;i<0&&r>0&&(u=r+Math.abs(i)),n.ratio=u/n.maxPos,n.range=u,n.ready||(n.settings.layout==t.INVERTED&&n.$handle.css(n.props.pos,n.maxPos),n.ready=!0)}}function o(t){atom.drag.on("move",this.onDragMove);atom.drag.on("stop",this.onDragEnd);var i={moveX:this.settings.orientation==n.HORIZONTAL,moveY:this.settings.orientation==n.VERTICAL,minX:this.minPos,maxX:this.maxPos,minY:this.minPos,maxY:this.maxPos};return atom.drag.start(t,this.$handle,i),!1}function s(){r(this),this.fireEvent("change")}function h(){atom.drag.off("move",this.onDragMove),atom.drag.off("stop",this.onDragEnd)}function r(n){if(n.$text||n.$control){var t=n.value();n.$text&&n.$text.text(t),n.$control&&n.$control.val(t)}}var i=this,n={HORIZONTAL:0,VERTICAL:1},t={NORMAL:0,INVERTED:1},e={"0":{pos:"left",min:"minX",max:"maxX",size:"width",outerSize:"outerWidth"},"1":{pos:"top",min:"minY",max:"maxY",size:"height",outerSize:"outerHeight"}};this.NAME="atom.controls.Slider",this.async=!1,this.expression=".slider",this.setup=function(){$(window).on("resize",this.redraw)},this.Settings=atom.Settings.extend(function(i,r){this.orientation=$(i).hasClass("vertical")?n.VERTICAL:n.HORIZONTAL,this.layout=this.orientation==n.VERTICAL?t.INVERTED:t.NORMAL,this.roundValues=this.getBoolean("roundValues",i,r,!0),this.minValue=this.getNumber("minValue",i,r,0),this.maxValue=this.getNumber("maxValue",i,r,100),this.value=this.getNumber("value",i,r),this.defaultValue=this.getNumber("defaultValue",i,r,this.minValue),this.textElement=this.getString("textElement",i,r,atom.string.EMPTY).trim(),this.controlElement=this.getString("controlElement",i,r,atom.string.EMPTY).trim(),this.maxValue<this.minValue&&(this.maxValue=this.minValue)}),this.Control=atom.HtmlControl.extend(function(n,t){this.construct(n,"change","reset"),this.settings=new i.Settings(n,t),this.props=e[this.settings.orientation],this.ready=!1,this.$handle=$("<div class='handle'/>"),this.$element.html(atom.string.EMPTY),this.$element.append(this.$handle),this.$text=u(this.$element,this.settings.textElement),this.$control=u(this.$element,this.settings.controlElement);this.$handle.on("mousedown",$.proxy(o,this));this.$handle.on("dblclick",$.proxy(this.reset,this));this.onDragMove=$.proxy(s,this),this.onDragEnd=$.proxy(h,this),this.minPos=0,this.maxPos=0,this.ratio=0,f(this),r(this),i.registerInstance(this)}),this.Control.prototype.reset=function(){this.value(this.settings.defaultValue)},this.Control.prototype.value=function(n){var u=parseInt(this.$handle.css(this.props.pos)),f=this.settings.layout==t.INVERTED?this.settings.minValue+(this.maxPos-u)*this.ratio:this.settings.minValue+u*this.ratio,i;return atom.type.isNumeric(n)?(n=Math.max(Math.min(parseFloat(n),this.settings.maxValue),this.settings.minValue),n!=f&&(i=n-this.settings.minValue,i=this.settings.layout==t.INVERTED?this.maxPos-i:i,u=Math.round(i/this.ratio),this.$handle.css(this.props.pos,u)),r(this),this.fireEvent("change")):n=f,this.settings.roundValues?Math.round(n):n},this.redraw=function(){for(var n=0;n<i.instances.length;n++)f(i.instances[n])}}),atom.controls.Thumbstrip=atom.controls.register(new function(){function f(n,t){t.end=this.targetPos}function o(){this.animEngaged=!1}function s(n,t){var r,u;if(t<0&&n.currentIndex==n.$children.length-1||t>0&&n.currentIndex==0)return n.currentIndex;var f=Number.POSITIVE_INFINITY,i=-1,e=-n.$element.position()[n.props.position];for(r=0;r<n.snapCoords.length;r++)u=Math.abs(e-n.snapCoords[r]),u<f&&(f=u,i=r);return t>0&&i>=n.currentIndex&&(i=n.currentIndex-1),t<0&&i<=n.currentIndex&&(i=n.currentIndex+1),i}function h(n){for(var i=[],r=parseInt(n.$element.css(n.props.paddingStart)),t=0;t<n.$children.length;t++){var u=n.$children.eq(t),f=n.$children[t][n.props.offsetPos],e=parseInt(u.css(n.props.marginStart))||0,o=f-(r+e);i.push(o)}return i}function c(n){if(!this.wasDragged){for(var i=$(n.target);!i.parent().is(this.$element);)if(i=i.parent(),i.length==0)return;this.settings.scrollOnClick&&t(this,i.index(),!0)}}function l(n){if(!this.animEngaged){var i=-n.originalEvent.wheelDelta||n.originalEvent.detail;i>0&&this.currentIndex<this.snapCoords.length-1&&t(this,this.currentIndex+1),i<0&&this.currentIndex>0&&t(this,this.currentIndex-1)}}function a(t){var u,o;if(!atom.drag.active&&(u=this.$container[this.props.outerSize](),this.settings.autoScroll&&u!=0)){var s=$("html"),h=this.$container.offset(),f=t.clientX-h.left+s.prop("scrollLeft"),e=t.clientY-h.top+s.prop("scrollTop");if(this.moveEngaged=this.stripLength>u&&f>=this.minMouseX&&f<=this.maxMouseX&&e>=this.minMouseY&&e<=this.maxMouseY,this.moveEngaged){var c=this.settings.orientation==n.VERTICAL?e:f,i=Math.round(-(c*this.ratio)+this.settings.extraLength),l=parseInt(this.$element.css(this.props.position)),a=Math.abs(l-i)>r;this.targetPos=i,this.settings.useAnimations&&a&&!this.animEngaged&&(o={},o[this.props.position]=i,this.$element.animate(o,this.animSettings),this.animEngaged=!0),this.settings.useAnimations&&this.animEngaged||this.$element.css(this.props.position,i)}}}function v(t){if(!this.settings.mouseDraggable||this.animEngaged||(this.wasDragged=!1,this.stripLength<=this.containerLength)||atom.dom.isTouchDevice&&t.originalEvent.touches.length!=1)return!0;var i={moveX:this.settings.orientation==n.HORIZONTAL,moveY:this.settings.orientation==n.VERTICAL,maxX:0,maxY:0,minX:this.minX,minY:this.minY};this.endListener=$.proxy(w,this),this.moveListener=$.proxy(p,this);atom.drag.on("stop",this.endListener);atom.drag.on("move",this.moveListener);return atom.drag.start(t,this.$element,i)}function y(n){return this.settings.mouseDraggable&&this.wasDragged?atom.event.cancel(n):!0}function p(){this.wasDragged=!0,this.fireEvent("move")}function w(){var i,r;this.wasDragged&&(i=this.settings.orientation==n.HORIZONTAL?e.data.specs.accelX:e.data.specs.accelY,this.settings.snapToItems?(r=s(this,i),t(this,r)):this.fireEvent("stop"),atom.drag.off("stop",this.endListener))}function t(n,t,i){var r;if(!this.animEngaged){var u={},e=n[n.props.minPos],o=n[n.props.maxPos],f=Math.min(Math.max(-n.snapCoords[t],e),o);if(u[n.props.position]=f,n.$element.position()[n.props.position]==f){n.fireEvent("select");return}r={duration:500,easing:"easeOutExpo"},r.done=function(){n.animEngaged=!1,n.currentIndex=t,n.fireEvent("stop"),i&&n.fireEvent("select")},r.progress=function(){n.fireEvent("move")},n.$element.stop().animate(u,r),n.animEngaged=!0}}var r=10,n={VERTICAL:0,HORIZONTAL:1},u={"0":{scrollSize:"scrollHeight",outerSize:"outerHeight",size:"height",position:"top",offsetPos:"offsetTop",minPos:"minY",maxPos:"maxY",paddingStart:"paddingTop",paddingEnd:"paddingBottom",marginStart:"marginTop"},"1":{scrollSize:"scrollWidth",outerSize:"outerWidth",size:"width",position:"left",offsetPos:"offsetLeft",minPos:"minX",maxPos:"maxX",paddingStart:"paddingLeft",paddingEnd:"paddingRight",marginStart:"marginLeft"}},i=this;this.NAME="atom.controls.Thumbstrip",this.async=!1,this.expression=".thumbstrip",this.setup=function(){$(window).on("resize",this.redraw)},this.redraw=function(){for(var n=0;n<i.instances.length;n++)i.instances[n].redraw()},this.Settings=atom.Settings.extend(function(t,i){this.orientation=$(t).hasClass("vertical")?n.VERTICAL:n.HORIZONTAL,this.extraLength=this.getNumber("extra-length",t,i,0),this.useAnimations=this.getBoolean("use-animations",t,i,!0),this.autoScroll=this.getBoolean("auto-scroll",t,i,!0),this.mouseDraggable=this.getBoolean("draggable",t,i,!1),this.snapToItems=this.getBoolean("snap-to-items",t,i,!1),this.scrollOnClick=this.getBoolean("scroll-on-click",t,i,!1)}),this.Control=atom.HtmlControl.extend(function(t,r){this.construct(t,"move","stop","select"),this.settings=new i.Settings(t,r),this.props=u[this.settings.orientation],this.$element.css({position:"relative",overflow:"hidden"}),this.settings.orientation==n.HORIZONTAL&&this.$element.css({whiteSpace:"nowrap"}),this.$children=this.$element.children("*"),this.$container=this.$element.parent(),this.moveEngaged=!1,this.animEngaged=!1,this.wasDragged=!1,this.stripLength=0,this.currentIndex=0,this.minMouseX=0,this.minMouseY=0,this.maxMouseX=this.$container.outerWidth(),this.maxMouseY=this.$container.outerHeight(),this.startPos=this.$element.position()[this.props.position],this.animSettings={complete:$.proxy(o,this),step:$.proxy(f,this),duration:400,easing:"easeOutExpo"};this.$element.on("mousedown touchstart",$.proxy(v,this));this.$element.on("click touchend",$.proxy(y,this));if(!atom.dom.isTouchDevice)$(document).on("mousemove",$.proxy(a,this));this.$children.bind("click touchend",$.proxy(c,this));this.$element.on("mousewheel DOMMouseScroll",$.proxy(l,this));this.redraw()}),this.Control.prototype.redraw=function(n){var i=this.$container[this.props.size](),t=(parseInt(this.$element.css(this.props.paddingStart))||0)+(parseInt(this.$element.css(this.props.paddingEnd))||0),r,f,e,u;for(this.$children=this.$element.children("*"),r=0;r<this.$children.length;r++)f=this.$children.eq(r),t+=f[this.props.outerSize](!0);if(this.minMouseX=0,this.minMouseY=0,this.maxMouseX=this.$container.outerWidth(),this.maxMouseY=this.$container.outerHeight(),this.containerLength=i,this.stripLength=t,this.maxX=0,this.maxY=0,this.minX=this.containerLength-this.stripLength-(parseInt(this.$element.css(this.props.paddingStart))||0),this.minY=this.containerLength-this.stripLength,e=t-i+this.startPos+this.settings.extraLength*2,this.ratio=e/i,this.stripLength=t+this.settings.extraLength,this.$element.css(this.props.size,t),this.snapCoords=h(this),t<i)this.$element.css(this.props.size,i),this.$element.css(this.props.position,0);else{u=parseInt(this.$element.css(this.props.position))||0,n&&(u=-this.snapCoords[this.currentIndex]);var o=this[this.props.minPos],s=this[this.props.maxPos],c=Math.min(Math.max(u,o),s);this.$element.css(this.props.position,c)}}}),atom.controls.Tooltip=atom.controls.register(new function(){function a(i,r,f,e,o,s){var h={orientation:f,left:0,arrowLeft:0,arrowRight:0},a=6,v=t.documentElement.scrollLeft,c=u+i-v,l=n.outerWidth()+a;return f=="L"?(h.left=c-l-s,h.arrowLeft="auto",h.arrowRight=0):(h.left=c+r+a+s,h.arrowLeft=0,h.arrowRight="auto"),h.left<e?(h.left=c+r+s,h.orientation="R",h.arrowLeft=0,h.arrowRight="auto"):h.left+l>o&&(h.left=c-l-s,h.orientation="L",h.arrowLeft="auto",h.arrowRight=0),h}function v(i,r,f,e,o){var s={left:0,arrowLeft:0,arrowRight:0},v=t.documentElement.scrollLeft,a=u+i-v,h=n.outerWidth(),l=12,c;return f=="L"?(s.left=a,s.arrowLeft=l):f=="R"?(s.left=a+r-h,s.arrowLeft=h-l*2):(s.left=a+(r/2-h/2),s.arrowLeft=h/2-l/2),s.left<e?(s.left=a,s.arrowLeft=l,f="L",s.left+h>o&&(c=s.left+h-o,s.left-=c,s.arrowLeft+=c)):s.left+h>o&&(s.left=a+r-h,s.arrowLeft=h-l*2,f="R",s.left<e&&(c=e-s.left,s.left+=c,s.arrowLeft-=c)),r<l*3&&(c=l*1.5-r/2,f=="L"?s.left-=c:s.left+=c),s}function y(i,u,f,e,o,s){var h={orientation:f,top:0,arrowTop:0,arrowBottom:0},a=6,v=t.documentElement.scrollTop,c=r+i-v,l=n.outerHeight()+a;return f=="T"?(h.top=c-l-s,h.arrowTop="auto",h.arrowBottom=0):(h.top=c+u+a+s,h.arrowTop=0,h.arrowBottom="auto"),h.top<e?(h.top=c+u+s,h.orientation="B",h.arrowTop=0,h.arrowBottom="auto"):h.top+l>o&&(h.top=c-l-s,h.orientation="T",h.arrowTop="auto",h.arrowBottom=0),h}function p(i,u,f,e,o){var s={top:0,arrowTop:0,arrowBottom:0},c=12,v=t.documentElement.scrollTop,a=r+i-v,h=n.outerHeight(),l;return f=="B"?(s.top=a,s.arrowTop=c):f=="T"?(s.top=a+u-h,s.arrowTop=h-c*2):(s.top=a+(u/2-h/2),s.arrowTop=h/2-c/2),s.top<e?(s.top=a,s.arrowTop=c,f="T",s.top+h>o&&(l=s.top+h-o,s.top-=l,s.arrowTop+=l)):s.top+h>o&&(s.top=a+u-h,s.arrowTop=h-c*2,f="B",s.top<e&&(l=e-s.top,s.top+=l,s.arrowTop-=l)),u<c*2&&(f=="T"?s.top-=c*.8:s.top+=c*.8),s}function w(){(window.clearTimeout(f),!i||i==this||i.settings.hideOn.contains("mouseout"))&&this.settings.showOn.contains("mouseover")&&(this.$element.hasClass("tooltip-suspend")||(this.settings.delay>0?f=window.setTimeout(this.showTooltip,this.settings.delay):this.showTooltip()))}function b(){(window.clearTimeout(f),i==this)&&this.settings.hideOn.contains("mouseout")&&this.hide()}function k(){this.settings.showOn.contains("focus")&&this.show()}function d(){this.settings.hideOn.contains("blur")&&this.hide()}function c(){n.is(":visible")&&this.settings.hideOn.contains("click")?this.hide():!n.is(":visible")&&this.settings.showOn.contains("click")&&this.show()}function g(t){n.is(":visible")&&i==this&&(jQuery.contains(this.$element[0],t.target)||jQuery.contains(n[0],t.target)||this.hide())}function nt(n){return this.each(function(t,i){initializeSingleElement(i,n)})}function l(){var e,i,f,o,n;r=0,u=0,e=!1;try{t=top.document}catch(s){t=document,e=!0}if(!e&&(i=window,window!=window.parent))while(i!=top)for(i=i.parent,f=$("iframe, frame",i.document),o=!1,n=0;n<f.length;n++)if(f[n].contentWindow==window){u+=f.eq(n).offset().left,r+=f.eq(n).offset().top,o=!0;break}}function tt(){var o=$(t.getElementById(e)),c,r,u,f,i,l;if(o.length!=0)n=o;else if(c=atom.string.format('<div id="{0}"><div class="arrow"><\/div><div class="bg"><\/div><div class="content"><\/div><\/div>',e),n=$(c),$(t.body).append(n),t!=document){for(r=$("<style id='tooltipStyles'><\/style>"),$(t.body).append(r),u=[],f=atom.css.findRules("#tooltip"),i=0;i<f.length;i++)l=f[i],u.push(l.css.cssText);r.html(u.join("\n"))}h=n.find(".content"),s=n.find(".arrow")}var e="tooltip_popup",o=this,i=null,n=null,s=null,t=null,h=null,r=0,u=0,f;this.NAME="atom.controls.Tooltip",this.async=!1,this.expression=".tooltip",this.setup=function(){n==null&&(l(),tt(),$.fn.tooltip=nt,$(window).resize(l))},this.Settings=atom.Settings.extend(function(n,t){this.construct(n,t),this.className=this.getString("className",n,t,null),this.followMouse=this.getBoolean("followMouse",n,t,!0),this.maxWidth=this.getString("maxWidth",n,t,null),this.showOn=this.getString("showOn",n,t,"mouseover").split(/(?:\s*,\s*)|(?:\s+)/),this.hideOn=this.getString("hideOn",n,t,"mouseout").split(/(?:\s*,\s*)|(?:\s+)/),this.orientation=this.getString("orientation",n,t,"TL").toUpperCase(),this.offset=this.getNumber("offset",n,t,3),this.delay=this.getNumber("delay",n,t,200),this.obscureOnly=this.getBoolean("obscureOnly",n,t,!1),this.useFades=this.getBoolean("useFades",n,t,!1)}),this.Control=atom.HtmlControl.extend(function(i,r){this.construct(i),this.settings=new o.Settings(i,r),this.$element.bind("mouseenter",$.proxy(w,this)).bind("mouseleave",$.proxy(b,this)).bind("focus",$.proxy(k,this)).bind("blur",$.proxy(d,this)).bind("click",$.proxy(c,this)),$(t).bind("keydown click",$.proxy(g,this)),this.showTooltip=$.proxy(this.show,this),n.bind("click",$.proxy(c,this)),o.registerInstance(this)}),this.Control.prototype.hide=function(){this.$element.attr("title",this.$element.attr("_title")),this.$element.removeAttr("_title");var t=this.settings.className;this.settings.useFades?n&&n.fadeOut(function(){t&&n.removeClass(t)}):(n.hide(),t&&n.removeClass(t)),i=null},this.Control.prototype.show=function(){var e,o,w;if(!this.$element.hasClass("tooltip-suspend")&&(!this.settings.obscureOnly||(e=this.$element[0],!(e.scrollWidth<=e.offsetWidth)||!(e.scrollHeight<=e.offsetHeight)))&&(o=this.$element.attr("title")||this.$element.attr("data-title")||this.$element.attr("_title"),o)){this.$element.attr("_title",o),this.$element.attr("title",atom.string.EMPTY),w=this.settings.maxWidth||$(t).width()*.75,n.css("max-width",w+"px"),h.html(o);var c=this.settings.orientation,l=c[0].match(/T|L|R|B/)?c[0]:"T",b=c[1].match(/T|L|R|B|C/)?c[1]:"L",k=$("html",t)[0],d=$("body",t)[0],g=k.scrollWidth||d.scrollWidth,nt=k.scrollHeight||d.scrollHeight;n.css({left:0,top:-1e3,display:"block"}).removeClass("t l r b");var tt=this.settings.offset,it=this.$element.offset().top,rt=this.$element.offset().left,ut=this.$element.height(),ft=this.$element.width();if(l.match(/T|B/))var r=y(it,ut,l,0,nt,tt),u=v(rt,ft,b,0,g),f={popupLeft:u.left,popupTop:r.top,arrowLeft:u.arrowLeft,arrowRight:u.arrowRight,arrowTop:r.arrowTop,arrowBottom:r.arrowBottom,orientation:r.orientation};else r=a(rt,ft,l,0,g,tt),u=p(it,ut,b,0,nt),f={popupLeft:r.left,popupTop:u.top,arrowLeft:r.arrowLeft,arrowRight:r.arrowRight,arrowTop:u.arrowTop,arrowBottom:u.arrowBottom,orientation:r.orientation};n.css({left:f.popupLeft,top:f.popupTop}),s.css({left:f.arrowLeft,top:f.arrowTop}),n.addClass(f.orientation.toLowerCase()),i=this,this.settings.useFades&&n.fadeIn()}},this.Control.prototype.set=function(n,t){return t&&(n=="showOn"||n=="hideOn")&&(t=t.split(/(?:\s*,\s*)|(?:\s+)/)),this.settings[n]!=undefined&&(this.settings[n]=t),this.settings[n]}})